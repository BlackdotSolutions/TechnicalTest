@{
   ViewData["Title"] = "Home Page";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<div class="text-center">
   <h1 class="display-4">Search Multiple Engines</h1>
      <form method="post" >
       <fieldset>
         <div>
           <label for="CompanyName">Enter Search Details:</label>
             <input type="text" id="SearchText" name="SearchText" value="" /><label>&nbsp;</label>
             <button type="button" id="showSearchResults">Show Results</button><br>
         </div>
         <div>
        <div class="container">  
       <br />  
       <div style="width:90%; margin:0 auto;">  
           <table id="tblResults" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">  
             <thead>  
             <tr>  
               <th>Result</th>  
               <th>Google Rank</th>      
               <th>DuckDuckGo Rank</th>   
             </tr>  
             </thead>
             <tbody id='tb'>
                 </tbody>
           </table> 

       </div>
            <ul id="results" />
   </div>            
         </div>
       </fieldset>
     </form>
</div>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>

<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
 <script>

   $(document).ready(function () {

       // Get Search Results
       $("#showSearchResults").click(function () {
           try {
               $.post("/Home/DoSearch/", { searchTerm: JSON.stringify($("#SearchText").val())
               }, function (results) {
                   for (var result = 0; result < results.length; result++)
                   { 
                     var ranksString = '';

                     for (var displayedRankIndex = 0; displayedRankIndex < results[result].displayedRanks.length; displayedRankIndex++)
                      {
                        ranksString += '<td>' + results[result].displayedRanks[displayedRankIndex].item2 + '</td>';
                      }

                      $('#tblResults tr:last').after('<tr id="RowResult"><td><a href=\"'
                          + results[result].uri + '\">'
                          + results[result].title 
                          + '</a></td>' + ranksString +'</tr>');                       
                   }
               });


           }
           catch (e) {
               window.alert("Got here" + e);
               console.log(e);
           }
       });


     // Remove results if different search in box
    $("input[name='SearchText']").on("propertychange change  input paste ", function () {


       var elmtTable = document.getElementById("tblResults");
       var tableRows = table.querySelectorAll('tr[id="RowResult"');
       var rowCount = tableRows.length;
       console.log("here " + tableRows.length);
        for(var i=0; i < tableRows.length; i++){
            tabledeleteRow(rowCount[i].rowIndex);
        }

        });
       });
 </script>